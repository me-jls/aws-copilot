# Doc : https://aws.github.io/copilot-cli/docs/manifest/lb-web-service/
# Your service name will be used in naming your resources like log groups, ECS services, etc.
name: pgw-github
type: Load Balanced Web Service

# Distribute traffic to your service.
http:
  path: '/'
  healthcheck:
    path: '/-/healthy'
    success_codes: '200'
#     healthy_threshold: 3
#     unhealthy_threshold: 2
#     interval: 15s
#     timeout: 10s
#     grace_period: 45s
#   deregistration_delay: 5s
#   stickiness: false
#   allowed_source_ips: ["10.24.34.0/23"]
#  alias: pgw-github.<DOMAIN-NAME>

# Configuration for your containers and service.
image:
#   build:
#     dockerfile: ./frontend/Dockerfile
#     context: ./frontend
#
  location: prom/pushgateway:v1.4.1
#  TODO: reference your AWS Secret Manager URN to enable access to private registry
#  credentials: <your-secret>
  port: 9091
  labels:
    ECS_PROMETHEUS_EXPORTER_PORT: 9091
    JLS: v2
  
cpu: 256
memory: 512
count:
  range: 1-2
  cpu_percentage: 80
#   memory_percentage: 80
#   requests: 10000
#   response_time: 2s
exec: true

variables:
  LOG_LEVEL: info

# secrets:
#   GITHUB_TOKEN: GITHUB_TOKEN

# You can override any of the values defined above by environment.
# environments:
#   test:
#     count:
#       range:
#         min: 1
#         max: 3
#         spot_from: 2
#   staging:
#     count:
#       spot: 2
#   production:
#     count: 2